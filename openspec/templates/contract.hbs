{{!-- Phase 1 Step 4: API Spec (spec.md) --}}

# Role
You are the System Architect.

# Goal
Generate the **Source of Truth** (Step 4 Spec) based on `proposal.md`.

# Output Format (Markdown with JSON Examples)
Generate a `spec.md` file with the following structure:

---

# {{ feature_name }} - API Specification

## Overview
<!-- Brief description of this feature's API -->

## API Endpoints

### `{{ method }} {{ path }}`

**Summary**: <!-- endpoint description -->

**Request**:
```json
{
  // Request body example
}
```

**Response** (Success):
```json
{
  "code": 0,
  "message": "success",
  "data": {
    // Response data example - MUST follow StandardResp structure
  }
}
```

**Response** (Error):
```json
{
  "code": 1000,
  "message": "Invalid Parameter",
  "data": null,
  "error_details": {
    "field": "xxx",
    "reason": "xxx",
    "trace_id": "uuid-v4"
  }
}
```

**Error Codes** (refer to `infrastructure.md` for complete list):
| Code | Message | When to Use |
|------|---------|-------------|
| 1000 | Invalid Parameter | Missing or malformed request parameter |
| 2000 | Resource Not Found | Requested resource doesn't exist |
| 4000 | Database Error | Database operation failure |
| 5000 | Internal Server Error | Unexpected system error |

**Logging Requirements**:
- Log all requests with `trace_id` (from X-Request-ID header)
- Log slow operations (>1s) with duration metrics
- Log errors with full context (user_id, request params, stack trace)
- Use structured logging format (refer to `infrastructure.md`)

---

## Database Schema

### Table: `{{ table_name }}`

| Column | Type | Nullable | Description |
|--------|------|----------|-------------|
| id | SERIAL | NO | Primary Key |
| ... | ... | ... | ... |
| created_at | TIMESTAMP | NO | Creation time |
| updated_at | TIMESTAMP | NO | Last update time |

**Indexes**:
- `idx_{{ table_name }}_xxx` ON (xxx)

**Constraints**:
- PRIMARY KEY (id)
- UNIQUE (xxx)

---

## Validation Checklist

- [ ] All endpoints have JSON request/response examples
- [ ] All responses follow StandardResp structure
- [ ] Database tables define necessary indexes
- [ ] Error codes are documented and follow infrastructure.md standards
- [ ] Logging requirements are specified for critical operations
- [ ] Request headers include X-Request-ID for tracing
- [ ] Pagination endpoints return total_count
- [ ] Error responses include error_details with trace_id
